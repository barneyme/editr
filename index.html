<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>editr</title>
        <link rel="stylesheet" href="style.css" />
        <link
            rel="icon"
            href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 16 16'><rect width='16' height='16' fill='%23666666'/><text x='8' y='12' font-family='monospace' font-size='12' fill='white' text-anchor='middle'>e</text></svg>"
        />
    </head>
    <body>
        <textarea
            id="editor"
            placeholder="Start typing or press Ctrl\Cmd + K for menu."
            autocomplete="off"
            autocorrect="off"
            autocapitalize="off"
            spellcheck="false"
        ></textarea>

        <div id="findReplaceDialog" class="hidden">
            <input
                type="text"
                id="findInput"
                placeholder="Find (Enter/Shift+Enter)"
            />
            <div class="find-controls">
                <button id="findPrevBtn" title="Find Previous (Shift+Enter)">
                    ↑
                </button>
                <button id="findNextBtn" title="Find Next (Enter)">↓</button>
            </div>
            <input type="text" id="replaceInput" placeholder="Replace" />
            <div class="replace-controls">
                <button id="replaceBtn" title="Replace">Replace</button>
                <button id="replaceAllBtn" title="Replace All">All</button>
            </div>
            <button id="closeFindBtn" title="Close (Esc)">&times;</button>
        </div>

        <div id="commandPalette" class="hidden">
            <div class="palette-container">
                <input
                    type="text"
                    id="commandInput"
                    placeholder="Search commands or files..."
                    autocomplete="off"
                />
                <div id="commandList"></div>
            </div>
        </div>

        <div id="helpModal" class="hidden modal-base">
            <button id="closeHelpBtn" class="modal-close-btn">&times;</button>
            <h3>editr Help & Shortcuts</h3>
            <pre id="helpText">
..................................
editr : browser editor
..................................
<div id="currentBuffer">Buffer: 1/1 - editr.txt</div>
<div id="wordCount">Words: 0 | Lines: 0</div>
..................................
HELP
..................................
Ctrl/Cmd + F : Find and Replace
Ctrl/Cmd + E : Text expansions
Ctrl/Cmd + S : Save file
Ctrl/Cmd + O : Open file
Ctrl/Cmd + N : New tab
Ctrl/Cmd + W : Close buffer
Ctrl/Cmd + D : Dark/light mode
Ctrl/Cmd + = : Lock/unlock note
Ctrl/Cmd + 1~9 : Switch buffers
Ctrl/Cmd + ←/→ : Switch buffers
F11          : Full screen
Ctrl/Cmd + K : Open command palette
Right-click  : Context Menu
..................................
EXPANSIONS
..................................
Type a shortcut and press Space/Enter.
.d           : Insert current date (YYYYMMDD)
.a ~ .z    : User customizable
..................................
Files auto-save in browser.
Word wrap is on by default.
Made by [Barney](www.barney.me)
..................................
            </pre>
        </div>

        <div id="expansionsModal" class="hidden modal-base">
            <button id="closeExpansionsBtn" class="modal-close-btn">
                &times;
            </button>
            <h3>Text Expansions</h3>
            <div id="expansionsList"></div>
            <div class="expansions-footer">
                <button
                    id="importExpansionsBtn"
                    title="Import from a .txt file"
                >
                    Import
                </button>
                <button id="exportExpansionsBtn" title="Export to a .txt file">
                    Export
                </button>
                <button id="saveExpansionsBtn" title="Save changes and close">
                    Save & Close
                </button>
            </div>
        </div>

        <div id="contextMenu">
            <div id="ctxBufferList"></div>
            <hr class="context-menu-divider" id="ctxBufferDivider" />

            <div class="context-menu-item has-submenu">
                <span>File</span>
                <div class="submenu">
                    <div class="context-menu-item" id="ctxNewTab">New Tab</div>
                    <div class="context-menu-item" id="ctxOpenFile">
                        Open File
                    </div>
                    <div class="context-menu-item" id="ctxSaveFile">
                        Save File As
                    </div>
                    <hr class="context-menu-divider" />
                    <div class="context-menu-item" id="ctxFindReplace">
                        Find / Replace
                    </div>
                </div>
            </div>

            <div class="context-menu-item has-submenu">
                <span>Buffer</span>
                <div class="submenu">
                    <div class="context-menu-item" id="ctxNextBuffer">
                        Next Buffer
                    </div>
                    <div class="context-menu-item" id="ctxPrevBuffer">
                        Previous Buffer
                    </div>
                    <div class="context-menu-item" id="ctxCloseBuffer">
                        Close Buffer
                    </div>
                </div>
            </div>

            <div class="context-menu-item has-submenu">
                <span>Tools</span>
                <div class="submenu">
                    <div class="context-menu-item" id="ctxCommandPalette">
                        Command Palette
                    </div>
                    <div class="context-menu-item" id="ctxToggleLock">
                        Lock/Unlock Note
                    </div>
                    <div class="context-menu-item" id="ctxManageExpansions">
                        Manage Expansions
                    </div>
                    <hr class="context-menu-divider" />
                    <div class="context-menu-item" id="ctxToggleDark">
                        Toggle Dark Mode
                    </div>
                    <div class="context-menu-item" id="ctxToggleWrap">
                        Toggle Word Wrap
                    </div>
                    <div class="context-menu-item" id="ctxToggleFullscreen">
                        Fullscreen
                    </div>
                </div>
            </div>

            <hr class="context-menu-divider" />
            <div class="context-menu-item" id="ctxShowHelp">Help</div>
        </div>

        <div id="mobileControls">
            <button class="mobile-btn" id="hamburgerBtn" title="Menu">
                ☰
            </button>
        </div>

        <input type="file" id="fileInput" accept=".txt,.md,.js,.html,.css" />
        <input
            type="file"
            id="importExpansionsInput"
            accept=".txt"
            style="display: none"
        />
        // GitHub Pages SPA redirect handler // Add this script to your
        index.html BEFORE script.js (function() { var redirect =
        sessionStorage.redirect; delete sessionStorage.redirect; if (redirect &&
        redirect != location.href) { history.replaceState(null, null, redirect);
        } })(); // Check for redirected URL parameters (function() { var l =
        window.location; if (l.search) { var q = {};
        l.search.slice(1).split('&').forEach(function(v) { var a = v.split('=');
        q[a[0]] = a.slice(1).join('=').replace(/~and~/g, '&'); }); if (q.p !==
        undefined) { window.history.replaceState(null, null, l.pathname.slice(0,
        -1) + (q.p || '') + (q.q ? ('?' + q.q) : '') + l.hash ); } } })();
        <script src="script.js"></script>
        <script>
            if ("serviceWorker" in navigator) {
                window.addEventListener("load", () => {
                    navigator.serviceWorker
                        .register("/sw.js")
                        .then((registration) => {
                            console.log(
                                "ServiceWorker registration successful with scope: ",
                                registration.scope,
                            );
                        })
                        .catch((error) => {
                            console.log(
                                "ServiceWorker registration failed: ",
                                error,
                            );
                        });
                });
            }
        </script>
    </body>
</html>
